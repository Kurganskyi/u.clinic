# Быстрый старт Uclinic Bot

## Минимальная настройка для запуска

### 1. Клонирование и установка

```bash
cd u.clinic
pip install -r requirements.txt
```

### 2. Создание .env файла

Скопируйте `.env.example` в `.env` и заполните **минимальный набор**:

```bash
cp .env.example .env
```

Отредактируйте `.env`:

```env
# ОБЯЗАТЕЛЬНЫЕ
TELEGRAM_BOT_TOKEN=123456:ABC-DEF...        # Получить от @BotFather
BITRIX24_WEBHOOK_URL=https://your-portal.bitrix24.ru/rest/1/abc123/
TELEGRAM_ADMIN_IDS=123456789              # Ваш Telegram ID (узнать у @userinfobot)

# ОПЦИОНАЛЬНЫЕ (значения по умолчанию)
DATABASE_URL=sqlite:///./bot.db           # SQLite для быстрого старта
WEBHOOK_PORT=5000                         # Порт для приема вебхуков
LOG_LEVEL=INFO
```

### 3. Быстрый запуск

```bash
python -m bot.main
```

Бот запустится и начнет слушать команды в Telegram!

## Первый тест

1. Найдите вашего бота в Telegram
2. Отправьте `/start`
3. Бот должен ответить приветствием

## Следующие шаги

### Настройка Битрикс24 (для уведомлений)

1. В Битрикс24: Настройки → Разработчикам → Вебхуки
2. Создайте исходящий вебхук:
   - События: `ONCRMDEALADD`, `ONCRMDEALUPDATE`
   - URL: `http://ваш-сервер:5000/webhook/bitrix24`
   - Секрет (опционально): укажите в `.env` как `WEBHOOK_SECRET`
3. Создайте входящий вебхук:
   - URL скопируйте в `.env` как `BITRIX24_WEBHOOK_URL`

### Для локального тестирования

Если вебхуки недоступны, можно использовать ngrok:

```bash
ngrok http 5000
```

Полученный URL используйте для настройки вебхуков в Битрикс24.

## Типичные проблемы

### "TELEGRAM_BOT_TOKEN не установлен"

❌ Проверьте `.env` файл и укажите правильный токен  
✅ Токен должен быть формата: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`

### "База данных заблокирована"

❌ Другой процесс использует БД  
✅ Закройте другие запуски бота, удалите `bot.db` и перезапустите

### "Вебхуки не приходят"

❌ Битрикс24 не может достучаться до бота  
✅ Проверьте, что порт 5000 открыт, используйте ngrok для локальной разработки

## Полная документация

Подробные инструкции: [SETUP.md](SETUP.md)

